!function(e){function t(){const t=document.querySelector(".js-main-nav"),n=document.querySelector(".js-page-header"),r=document.querySelector(".js-main-nav-trigger");e.addEvent(r,"click",function(e){e.preventDefault();var a=r.innerText,s=r.getAttribute("data-text-toggle");t.classList.toggle("nav-open"),n.classList.toggle("nav-open"),r.classList.toggle("nav-open"),r.innerText=s,r.setAttribute("data-text-toggle",a),s=a})}function n(){function t(t,n){function r(){i.innerHTML="",i.classList.remove("active")}t=t;var a=n,s=document.querySelector(".js-search-input"),i=document.querySelector(".js-search-results");e.addEvent(s,"keydown",function(e){switch(e.keyCode){case 38:if(e.preventDefault(),n=document.querySelector(".search-result.active"))if(n.classList.remove("active"),n.parentElement.previousSibling)n.parentElement.previousSibling.querySelector(".search-result").classList.add("active");return;case 40:if(e.preventDefault(),n=document.querySelector(".search-result.active")){if(n.parentElement.nextSibling){var t=n.parentElement.nextSibling.querySelector(".search-result");n.classList.remove("active"),t.classList.add("active")}}else(t=document.querySelector(".search-result"))&&t.classList.add("active");return;case 13:var n;if(e.preventDefault(),n=document.querySelector(".search-result.active"))n.click();else{var r=document.querySelector(".search-result");r&&r.click()}return}}),e.addEvent(s,"keyup",function(e){switch(e.keyCode){case 27:return r(),void(s.value="");case 38:case 40:case 13:return void e.preventDefault()}r();var n=this.value;if(""!==n){var c=t.query(function(e){var t=lunr.tokenizer(n);e.term(t,{boost:10}),e.term(t,{wildcard:lunr.Query.wildcard.TRAILING})});if(c.length>0){i.classList.add("active");var o=document.createElement("ul");for(var l in o.classList.add("search-results-list"),i.appendChild(o),c){var u=c[l],d=a[u.ref],v=document.createElement("li");v.classList.add("search-results-list-item"),o.appendChild(v);var f=document.createElement("a");f.classList.add("search-result"),f.setAttribute("href",d.url),v.appendChild(f);var h=document.createElement("div");h.classList.add("search-result-title"),h.innerText=d.title,f.appendChild(h);var m=document.createElement("span");m.classList.add("search-result-rel-url"),m.innerText=d.relUrl,h.appendChild(m);var p=u.matchData.metadata,g=!1;for(var E in p)if(p[E].title){var L=(b=p[E].title.position[0])[0],y=b[0]+b[1];h.innerHTML=d.title.substring(0,L)+'<span class="search-result-highlight">'+d.title.substring(L,y)+"</span>"+d.title.substring(y,d.title.length)+'<span class="search-result-rel-url">'+d.relUrl+"</span>"}else if(p[E].content&&!g){g=!0;for(var b,S=L=(b=p[E].content.position[0])[0],q=y=b[0]+b[1],x=!0,j=!0,k=0;k<3;k++){var w=d.content.lastIndexOf(" ",S-2);if((T=d.content.lastIndexOf(".",S-2))>0&&T>w){S=T+1,x=!1;break}if(w<0){S=0,x=!1;break}S=w+1}for(k=0;k<10;k++){var T;w=d.content.indexOf(" ",q+1);if((T=d.content.indexOf(".",q+1))>0&&T<w){q=T,j=!1;break}if(w<0){q=d.content.length,j=!1;break}q=w}var C=d.content.substring(S,L);x&&(C="... "+C),C+='<span class="search-result-highlight">'+d.content.substring(L,y)+"</span>",C+=d.content.substring(y,q),j&&(C+=" ...");var D=document.createElement("div");D.classList.add("search-result-preview"),D.innerHTML=C,f.appendChild(D)}}}}}),e.addEvent(s,"blur",function(){setTimeout(function(){r()},300)})}var n=new XMLHttpRequest;n.open("GET","https://blog.jamespj.com/assets/js/search-data.json",!0),n.onload=function(){if(n.status>=200&&n.status<400){var e=JSON.parse(n.responseText);lunr.tokenizer.separator=/[\s\-/]+/,t(lunr(function(){for(var t in this.ref("id"),this.field("title",{boost:200}),this.field("content",{boost:2}),this.field("url"),this.metadataWhitelist=["position"],e)this.add({id:t,title:e[t].title,content:e[t].content,url:e[t].url})}),e)}else console.log("Error loading ajax request. Request status:"+n.status)},n.onerror=function(){console.log("There was a connection error")},n.send()}function r(){document.querySelector(".js-main-content").focus()}e.addEvent=function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n)},e.removeEvent=function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n)},e.onReady=function(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"complete"==document.readyState&&e()})},e.onReady(function(){t(),r(),"undefined"!=typeof lunr&&n()})}(window.jtd=window.jtd||{});